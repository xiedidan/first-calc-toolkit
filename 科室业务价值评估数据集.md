# 科室业务价值评估数据集说明文档

> **文档版本**: V1.0  
> **创建日期**: 2025-11-13  
> **适用系统**: 医院科室业务价值评估工具  
> **文档状态**: 正式版

---

## 1. 文档概述

### 1.1 文档目的

本文档详细描述为了实现医院科室业务价值评估，需要准备的最简数据集。

### 1.2 目标读者

- 数据准备人员
- 系统实施人员
- 医院信息科技术人员

### 1.3 数据集用途

本数据集用于：
- 科室业务价值评估计算
- 生成科室业务价值汇总报表
- 生成科室业务价值明细报表（业务价值结构表）

---

## 2. 数据集架构概览

### 2.1 数据表分类

| 分类 | 表名 | 用途 | 是否必需 |
|------|------|------|----------|
| 基础配置 | 科室对照表 | 科室信息管理 | 是 |
| 基础配置 | 收费项目表 | 收费项目目录 | 是 |
| 业务数据 | 收费明细表 | 业务价值计算源数据 | 是 |
| 业务数据 | 工作量统计表 | 护理、会诊等工作量统计 | 是 |

---

## 3. 数据表详细规范

### 3.1 科室对照表 (departments)

#### 3.1.1 表说明

科室对照表用于管理医院科室信息，建立HIS科室、成本中心和核算单元之间的对照关系，并控制哪些科室参与业务价值评估。

#### 3.1.2 对应功能模块

- 系统功能：科室对照管理
- 前端页面：科室管理页面
- 数据来源：从HIS系统或成本核算系统导入

#### 3.1.3 字段定义

| 序号 | 中文名 | 英文名 | 字段类型 | 长度 | 是否必填 | 默认值 | 备注 |
|------|--------|--------|----------|------|----------|--------|------|
| 1 | 主键ID | id | INTEGER | - | 是 | 自增 | 系统自动生成 |
| 3 | 排序序号 | sort_order | NUMERIC | (10,2) | 是 | 0 | 用于界面显示排序 |
| 4 | HIS科室编码 | his_code | VARCHAR | 50 | 是 | - | HIS系统中的科室代码 |
| 5 | HIS科室名称 | his_name | VARCHAR | 100 | 是 | - | HIS系统中的科室名称 |
| 6 | 成本中心编码 | cost_center_code | VARCHAR | 50 | 否 | NULL | 成本核算系统中的成本中心代码 |
| 7 | 成本中心名称 | cost_center_name | VARCHAR | 100 | 否 | NULL | 成本核算系统中的成本中心名称 |
| 8 | 核算单元编码 | accounting_unit_code | VARCHAR | 50 | 否 | NULL | 绩效核算单元编码 |
| 9 | 核算单元名称 | accounting_unit_name | VARCHAR | 100 | 否 | NULL | 绩效核算单元名称 |
| 10 | 是否参与评估 | is_active | BOOLEAN | - | 是 | TRUE | 控制科室是否参与业务价值计算 |

#### 3.1.4 约束条件

- 主键：id
- 索引：his_code（用于快速查询）、sort_order（用于排序）

#### 3.1.6 数据准备要点

1. **必填字段**：his_code和his_name必须提供，这是科室的基本标识
2. **评估范围**：is_active字段控制哪些科室参与计算，默认为TRUE
3. **排序序号**：sort_order用于界面显示顺序，建议按科室重要性或业务顺序设置
4. **编码规范**：his_code应与HIS系统保持一致，避免后续数据关联问题

---

### 3.2 收费项目表 (charge_items)

#### 3.2.1 表说明

收费项目表存储医院HIS系统的收费项目目录，用于维度目录配置和收费明细数据关联。该表是业务价值评估的基础数据之一。

#### 3.2.2 对应功能模块

- 系统功能：收费项目管理
- 前端页面：收费项目管理页面
- 数据来源：从HIS系统导入

#### 3.2.3 字段定义

| 序号 | 中文名 | 英文名 | 字段类型 | 长度 | 是否必填 | 默认值 | 备注 |
|------|--------|--------|----------|------|----------|--------|------|
| 1 | 主键ID | id | INTEGER | - | 是 | 自增 | 系统自动生成 |
| 3 | 收费项目编码 | item_code | VARCHAR | 100 | 是 | - | HIS系统中的收费项目编码 |
| 4 | 收费项目名称 | item_name | VARCHAR | 255 | 是 | - | 收费项目的完整名称 |
| 5 | 收费类别 | item_category | VARCHAR | 100 | 否 | NULL | 如：药品费、检查费、治疗费等 |
| 6 | 单价 | unit_price | NUMERIC | 20 | 否 | NULL | 收费项目的单价 |
| 7 | 单位 | unit | VARCHAR | 20 | 否 | NULL | 计价单位，如：次、天、项等 |
| 8 | 规格型号 | specification | VARCHAR | 100 | 否 | NULL | 药品或耗材的规格型号 |

#### 3.2.4 约束条件

- 主键：id
- 索引：
  - item_code（用于快速查询）
  - item_name（用于模糊搜索）
  - item_category（用于分类筛选）

#### 3.2.6 数据准备要点

1. **编码唯一性**：item_code在同一医疗机构内必须唯一，建议使用HIS系统原始编码
2. **名称规范**：item_name应使用标准的医疗术语，便于后续维度目录配置
3. **分类管理**：item_category建议使用统一的分类标准，如国家医保分类
4. **完整性**：建议导入HIS系统的完整收费项目目录，避免后续数据关联缺失
5. **更新维护**：收费项目目录应定期与HIS系统同步，保持数据一致性

---

### 3.3 收费明细表 (业务数据表)

#### 3.3.1 表说明

收费明细表是业务价值评估的核心数据源，记录医院所有收费业务的明细信息。该表通常存储在HIS系统或数据仓库中，评估系统通过SQL查询从该表提取数据进行计算。

#### 3.3.2 对应功能模块

- 系统功能：计算引擎数据源
- 数据来源：HIS系统收费模块、数据仓库

#### 3.3.3 字段定义

| 序号 | 中文名 | 英文名 | 字段类型 | 长度 | 是否必填 | 默认值 | 备注 |
|------|--------|--------|----------|------|----------|--------|------|
| 1 | 收费明细ID | charge_detail_id | VARCHAR/BIGINT | 50 | 是 | - | 唯一标识每条收费记录 |
| 2 | 收费时间 | charge_time | TIMESTAMP | - | 是 | - | 收费发生的时间 |
| 3 | 收费项目编码 | item_code | VARCHAR | 100 | 是 | - | 关联收费项目表的item_code |
| 4 | 收费项目名称 | item_name | VARCHAR | 255 | 是 | - | 收费项目名称（冗余字段） |
| 5 | 收费类别 | item_category | VARCHAR | 100 | 是 | - | 收费项目分类 |
| 6 | 单位 | unit | VARCHAR | 20 | 否 | NULL | 计价单位 |
| 7 | 单价 | unit_price | DECIMAL | (10,2) | 是 | - | 单次收费单价 |
| 8 | 规格型号 | specification | VARCHAR | 100 | 否 | NULL | 药品或耗材规格 |
| 9 | 数量 | quantity | DECIMAL | (10,2) | 是 | - | 收费数量 |
| 10 | 金额 | amount | DECIMAL | (10,2) | 是 | - | 总金额（单价×数量），退费为负值 |
| 11 | 开单科室编码 | prescribing_dept_code | VARCHAR | 50 | 是 | - | 开具处方/医嘱的科室编码 |
| 12 | 开单科室名称 | prescribing_dept_name | VARCHAR | 100 | 是 | - | 开具处方/医嘱的科室名称 |
| 13 | 执行人员科室编码 | executor_dept_code | VARCHAR | 50 | 否 | NULL | 执行人员所属科室编码 |
| 14 | 执行人员科室名称 | executor_dept_name | VARCHAR | 100 | 否 | NULL | 执行人员所属科室名称 |
| 15 | 执行地点科室编码 | execution_location_code | VARCHAR | 50 | 否 | NULL | 实际执行地点的科室编码 |
| 16 | 执行地点科室名称 | execution_location_name | VARCHAR | 100 | 否 | NULL | 实际执行地点的科室名称 |
| 17 | 患者ID | patient_id | VARCHAR | 50 | 是 | - | 患者唯一标识 |
| 18 | 就诊类型 | visit_type | VARCHAR | 20 | 是 | - | 门诊、急诊、住院等 |
| 19 | 就诊ID | visit_id | VARCHAR | 50 | 是 | - | 本次就诊的唯一标识 |

#### 3.3.4 约束条件

- 主键：charge_detail_id
- 索引建议：
  - charge_time（用于按时间范围查询）
  - item_code（用于关联收费项目）
  - prescribing_dept_code（用于按开单科室统计）
  - executor_dept_code（用于按执行科室统计）
  - execution_location_code（用于按执行地点统计）
  - (charge_time, prescribing_dept_code)（复合索引，优化常用查询）

#### 3.3.6 数据准备要点

1. **时间范围**：建议至少准备最近36个月的收费明细数据，用于历史对比分析
2. **数据完整性**：
   - 必填字段不能为空
   - 开单科室编码必须与科室对照表中的his_code对应
   - 收费项目编码应与收费项目表中的item_code对应
3. **退费处理**：退费记录的amount字段应为负值，不要删除原收费记录
4. **科室编码一致性**：
   - prescribing_dept_code、executor_dept_code、execution_location_code应使用统一的科室编码体系
   - 建议与科室对照表中的his_code保持一致
5. **执行人员和执行地点**：
   - 执行人员科室：主刀医生、执行麻醉师、技师、护士等所属科室
   - 执行地点科室：诊室、病区、手术室、治疗室、医技科室等
   - 这两个维度对于业务价值分配至关重要
6. **数据质量**：
   - 定期检查数据质量，确保没有异常值（如负数量、异常金额等）
   - 确保科室编码的准确性，避免数据关联失败
7. **性能优化**：
   - 对于大数据量场景（百万级以上），建议按月分区存储
   - 创建合适的索引以提高查询性能

#### 3.3.7 业务场景说明

**场景1：门诊诊察**
- 开单科室：门诊科室（如内科）
- 执行人员科室：门诊科室（同开单科室）
- 执行地点科室：门诊诊室

**场景2：检验检查**
- 开单科室：临床科室（如内科、外科）
- 执行人员科室：医技科室（如检验科、放射科）
- 执行地点科室：医技科室（同执行人员科室）

**场景3：手术**
- 开单科室：手术科室（如外科）
- 执行人员科室：手术科室（主刀医生）、麻醉科（麻醉师）
- 执行地点科室：手术室

**场景4：药品**
- 开单科室：临床科室
- 执行人员科室：NULL或药剂科
- 执行地点科室：药房

---

### 3.4 工作量统计表 (workload_statistics)

#### 3.4.1 表说明

工作量统计表用于记录各科室每月的护理工作量、会诊工作量、MDT（多学科诊疗）工作量等非收费类业务指标。这些指标是业务价值评估的重要补充数据，特别是对于护理序列和医技序列的价值评估。

#### 3.4.2 对应功能模块

- 系统功能：计算引擎数据源
- 数据来源：HIS系统、护理系统、会诊系统、数据仓库

#### 3.4.3 字段定义

| 序号 | 中文名 | 英文名 | 字段类型 | 长度 | 是否必填 | 默认值 | 备注 |
|------|--------|--------|----------|------|----------|--------|------|
| 1 | 主键ID | id | INTEGER/BIGINT | - | 是 | 自增 | 系统自动生成 |
| 2 | 年月 | year_month | VARCHAR | 7 | 是 | - | 格式：YYYY-MM，如2025-10 |
| 3 | 科室编码 | department_code | VARCHAR | 50 | 是 | - | 关联科室对照表的his_code |
| 4 | 科室名称 | department_name | VARCHAR | 100 | 是 | - | 科室名称（冗余字段） |
| 5 | 出院人次数 | discharge_count | INTEGER | - | 否 | 0 | 当月出院患者人次 |
| 6 | 特级护理床日数 | special_nursing_days | INTEGER | - | 否 | 0 | 特级护理总床日数 |
| 7 | 一级护理床日数 | level1_nursing_days | INTEGER | - | 否 | 0 | 一级护理总床日数 |
| 8 | 二级护理床日数 | level2_nursing_days | INTEGER | - | 否 | 0 | 二级护理总床日数 |
| 9 | 三级护理床日数 | level3_nursing_days | INTEGER | - | 否 | 0 | 三级护理总床日数 |
| 10 | 特殊疾病护理床日数 | special_disease_nursing_days | INTEGER | - | 否 | 0 | 特殊疾病护理总床日数 |
| 11 | 新生儿护理床日数 | newborn_nursing_days | INTEGER | - | 否 | 0 | 新生儿护理总床日数 |
| 12 | 重症监护床日数 | icu_days | INTEGER | - | 否 | 0 | ICU/重症监护总床日数 |
| 13 | 门急诊留观数 | emergency_observation_count | INTEGER | - | 否 | 0 | 门急诊留观患者人次 |
| 14 | 会诊发起数 | consultation_initiated_count | INTEGER | - | 否 | 0 | 作为申请方发起的会诊次数 |
| 15 | 会诊参与数 | consultation_participated_count | INTEGER | - | 否 | 0 | 作为受邀方参与的会诊次数 |
| 16 | MDT发起数 | mdt_initiated_count | INTEGER | - | 否 | 0 | 发起的MDT讨论次数 |
| 17 | MDT参加数 | mdt_participated_count | INTEGER | - | 否 | 0 | 参加的MDT讨论次数 |

#### 3.4.4 约束条件

- 主键：id
- 唯一约束：(year_month, department_code) 组合唯一
- 索引建议：
  - year_month（用于按时间查询）
  - department_code（用于按科室查询）
  - (year_month, department_code)（复合索引，优化常用查询）

#### 3.4.6 数据准备要点

1. **数据粒度**：按月、按科室统计，每个科室每月一条记录
2. **时间格式**：year_month字段统一使用"YYYY-MM-01"格式，便于查询和排序
3. **科室编码一致性**：department_code必须与科室对照表中的his_code保持一致
4. **数据完整性**：
   - 所有参与评估的科室都应有对应月份的记录
   - 如果某项指标为0，应明确记录为0，而不是NULL
5. **护理床日数统计规则**：
   - 各级护理床日数应按实际护理级别统计
   - 同一患者同一天只能计入一个护理级别
   - 重症监护床日数单独统计，不与其他护理级别重复
6. **会诊和MDT统计规则**：
   - 会诊发起数：本科室作为申请方发起的会诊次数
   - 会诊参与数：本科室作为受邀方参与的会诊次数
   - MDT发起数：本科室主导发起的MDT讨论次数
   - MDT参加数：本科室参与的MDT讨论次数（不包括发起的）
7. **数据来源**：
   - 护理数据：从护理系统或HIS护理模块提取
   - 会诊数据：从会诊系统或HIS会诊模块提取
   - MDT数据：从MDT管理系统提取
8. **数据更新频率**：建议每月初更新上月数据

#### 3.4.7 业务场景说明

**场景1：护理序列价值评估**
- 使用各级护理床日数评估护理工作量
- 不同护理级别对应不同的权重或单价
- 特级护理和重症监护的权重通常较高

**场景2：会诊工作量评估**
- 会诊发起数反映科室的疑难病例处理能力
- 会诊参与数反映科室的专业技术支持能力
- 用于医生序列的价值评估

**场景3：MDT工作量评估**
- MDT发起数反映科室的多学科协作主导能力
- MDT参加数反映科室的专业技术贡献
- 用于医生序列和医技序列的价值评估

**场景4：出院人次评估**
- 反映科室的诊疗服务量
- 结合平均住院日、床位使用率等指标综合评估
- 用于医生序列的价值评估

---

## 4. 数据关联关系

### 4.1 表间关联图

```
┌─────────────────────┐          ┌───────────────────┐
│  科室对照表          │          │  收费项目表        │
│  (departments)      │          │  (charge_items)   │
│  - id (PK)          │          │  - id (PK)        │
│  - his_code (UK)    │          │  - item_code (UK) │
│  - his_name         │          │  - item_name      │
└────────┬────────────┘          └────────┬──────────┘
         │                                 │
         │ 关联                             │ 关联
         │ (通过his_code)                   │ (通过item_code)
         │                                 │
         ├────────┬───────────┬────────────┤
         │        │           │            │
         │        │           │            │
┌────────▼────────▼───────────▼────────┐  │
│   收费明细表 (业务数据表)              │  │
│   - charge_detail_id (PK)            │  │
│   - prescribing_dept_code   ─────────┼──┘
│   - executor_dept_code      ─────────┤ 关联到
│   - execution_location_code ─────────┤ departments.his_code
│   - item_code               ─────────┼─ 关联到
└──────────────────────────────────────┘   charge_items.item_code

┌──────────────────────────────────────┐
│   工作量统计表 (业务数据表)           │
│   - id (PK)                          │
│   - year_month                       │
│   - department_code  ────────────────┼─ 关联到
│   - department_name                  │   departments.his_code
│   - discharge_count                  │
│   - nursing_days (各级)              │
│   - consultation_count               │
│   - mdt_count                        │
└──────────────────────────────────────┘
```

### 4.2 关联关系说明

#### 4.2.1 科室对照表 ↔ 收费明细表

**关联字段**：
- departments.his_code ↔ charge_details.prescribing_dept_code
- departments.his_code ↔ charge_details.executor_dept_code
- departments.his_code ↔ charge_details.execution_location_code

**关联类型**：逻辑关联（非物理外键）

**关联说明**：
- 收费明细表中的科室编码字段应与科室对照表中的his_code对应
- 一个科室可以有多条收费明细记录（1:N关系）
- 收费明细表通常存储在外部系统，不建立物理外键约束

**数据一致性检查SQL**：
```sql
-- 检查开单科室编码是否都在科室对照表中
SELECT DISTINCT prescribing_dept_code
FROM charge_details
WHERE prescribing_dept_code NOT IN (
    SELECT his_code FROM departments WHERE hospital_id = {hospital_id}
);

-- 检查执行科室编码是否都在科室对照表中
SELECT DISTINCT executor_dept_code
FROM charge_details
WHERE executor_dept_code IS NOT NULL
  AND executor_dept_code NOT IN (
    SELECT his_code FROM departments WHERE hospital_id = {hospital_id}
);
```

#### 4.2.2 收费项目表 ↔ 收费明细表

**关联字段**：
- charge_items.item_code ↔ charge_details.item_code

**关联类型**：逻辑关联（非物理外键）

**关联说明**：
- 收费明细表中的item_code应与收费项目表中的item_code对应
- 一个收费项目可以有多条收费明细记录（1:N关系）
- 收费项目表用于维度目录配置和项目信息查询

**数据一致性检查SQL**：
```sql
-- 检查收费项目编码是否都在收费项目表中
SELECT DISTINCT item_code, item_name
FROM charge_details
WHERE item_code NOT IN (
    SELECT item_code FROM charge_items WHERE hospital_id = {hospital_id}
);
```

#### 4.2.3 科室对照表 ↔ 工作量统计表

**关联字段**：
- departments.his_code ↔ workload_statistics.department_code

**关联类型**：逻辑关联（非物理外键）

**关联说明**：
- 工作量统计表中的department_code应与科室对照表中的his_code对应
- 一个科室可以有多条工作量统计记录（按月统计，1:N关系）
- 工作量统计表通常存储在外部系统，不建立物理外键约束

**数据一致性检查SQL**：
```sql
-- 检查科室编码是否都在科室对照表中
SELECT DISTINCT department_code, department_name
FROM workload_statistics
WHERE year_month = '{current_year_month}'
  AND department_code NOT IN (
    SELECT his_code FROM departments WHERE hospital_id = {hospital_id}
  );
```

---

## 6. 数据质量要求

### 6.1 数据完整性要求

#### 6.1.1 必填字段完整性

| 表名 | 必填字段 | 检查SQL |
|------|----------|---------|
| departments | his_code, his_name | `SELECT COUNT(*) FROM departments WHERE his_code IS NULL OR his_name IS NULL` |
| charge_items | item_code, item_name | `SELECT COUNT(*) FROM charge_items WHERE item_code IS NULL OR item_name IS NULL` |
| charge_details | charge_detail_id, charge_time, item_code, amount, prescribing_dept_code | `SELECT COUNT(*) FROM charge_details WHERE charge_detail_id IS NULL OR charge_time IS NULL OR item_code IS NULL OR amount IS NULL OR prescribing_dept_code IS NULL` |
| workload_statistics | year_month, department_code, department_name | `SELECT COUNT(*) FROM workload_statistics WHERE year_month IS NULL OR department_code IS NULL OR department_name IS NULL` |

**要求**：以上检查SQL的结果应为0，表示没有必填字段为空的记录。

#### 6.1.2 数据关联完整性

**检查1：科室编码关联**
```sql
-- 检查收费明细中的开单科室是否都在科室对照表中
SELECT 
    COUNT(*) as missing_count,
    COUNT(DISTINCT prescribing_dept_code) as missing_dept_count
FROM charge_details cd
WHERE NOT EXISTS (
    SELECT 1 FROM departments d 
    WHERE d.his_code = cd.prescribing_dept_code 
    AND d.hospital_id = {hospital_id}
);
```

**检查2：收费项目编码关联**
```sql
-- 检查收费明细中的项目编码是否都在收费项目表中
SELECT 
    COUNT(*) as missing_count,
    COUNT(DISTINCT item_code) as missing_item_count
FROM charge_details cd
WHERE NOT EXISTS (
    SELECT 1 FROM charge_items ci 
    WHERE ci.item_code = cd.item_code 
    AND ci.hospital_id = {hospital_id}
);
```

**检查3：工作量统计表科室编码关联**
```sql
-- 检查工作量统计表中的科室编码是否都在科室对照表中
SELECT 
    COUNT(*) as missing_count,
    COUNT(DISTINCT department_code) as missing_dept_count
FROM workload_statistics ws
WHERE year_month = '{current_year_month}'
  AND NOT EXISTS (
    SELECT 1 FROM departments d 
    WHERE d.his_code = ws.department_code 
    AND d.hospital_id = {hospital_id}
  );
```

**要求**：以上检查SQL的missing_count应为0或在可接受范围内（< 1%）。

### 6.2 数据准确性要求

#### 6.2.1 数值字段合理性

**检查1：金额字段**
```sql
-- 检查异常金额（绝对值过大）
SELECT COUNT(*) 
FROM charge_details 
WHERE ABS(amount) > 100000;  -- 单笔金额超过10万

-- 检查单价异常
SELECT COUNT(*) 
FROM charge_details 
WHERE unit_price < 0 OR unit_price > 50000;
```

**检查2：数量字段**
```sql
-- 检查异常数量
SELECT COUNT(*) 
FROM charge_details 
WHERE quantity <= 0 OR quantity > 10000;
```

**要求**：异常记录数量应在合理范围内，需要人工审核确认。

#### 6.2.2 时间字段合理性

```sql
-- 检查未来时间
SELECT COUNT(*) 
FROM charge_details 
WHERE charge_time > NOW();

-- 检查过早时间（如早于医院建院时间）
SELECT COUNT(*) 
FROM charge_details 
WHERE charge_time < '2000-01-01';
```

**要求**：未来时间记录应为0，过早时间记录需要确认是否为历史数据迁移。

### 6.3 数据一致性要求

#### 6.3.1 编码规范一致性

**要求**：
- 科室编码应使用统一的编码规则（如全数字、字母+数字等）
- 收费项目编码应使用统一的编码规则
- 同一科室在不同表中的编码应完全一致（大小写、空格等）

**检查SQL**：
```sql
-- 检查科室编码格式一致性
SELECT his_code, COUNT(*) 
FROM departments 
GROUP BY his_code 
HAVING COUNT(*) > 1;  -- 应返回0条记录

-- 检查收费项目编码格式一致性
SELECT item_code, COUNT(*) 
FROM charge_items 
GROUP BY item_code 
HAVING COUNT(*) > 1;  -- 应返回0条记录
```

#### 6.3.2 名称规范一致性

```sql
-- 检查同一科室编码是否有不同名称
SELECT 
    prescribing_dept_code,
    COUNT(DISTINCT prescribing_dept_name) as name_count
FROM charge_details
GROUP BY prescribing_dept_code
HAVING COUNT(DISTINCT prescribing_dept_name) > 1;
```

**要求**：同一编码应对应唯一名称，如有差异需要统一。

---

## 7. 版本历史

| 版本 | 日期 | 修订人 | 修订内容 |
|------|------|--------|----------|
| V1.0 | 2025-11-13 | 谢地 | 初始版本，完整描述科室业务价值评估数据集 |
