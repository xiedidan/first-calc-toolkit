# 维度目录管理 - 快速使用指南

## 查看维度目录

### 方式1：按维度查看（推荐）

```
1. 选择模型版本
   ↓
2. 选择维度（下拉框显示完整路径）
   ↓
3. 点击"查询"
   ↓
4. 查看该维度的所有收费项目
```

**示例**：
```
模型版本: [2024版 ▼]
维度: [医疗服务 > 检查 > CT检查 ▼]
[查询]
```

### 方式2：查看孤儿记录

```
1. 点击"查看孤儿记录"按钮
   ↓
2. 查看所有无效的映射记录
   ↓
3. 点击"清除所有孤儿记录"清理
```

## 添加收费项目

### 手动添加

```
1. 选择维度
   ↓
2. 点击"添加收费项目"
   ↓
3. 搜索收费项目
   ↓
4. 勾选要添加的项目
   ↓
5. 点击"添加选中项目"
```

### 智能导入（推荐）

```
1. 准备Excel文件
   ↓
2. 点击"智能导入"
   ↓
3. 上传文件并映射字段
   ↓
4. 映射维度值
   ↓
5. 预览并确认
   ↓
6. 执行导入
```

## 智能导入详细步骤

### 步骤1：准备Excel文件

**按编码匹配**：
```
| 收费编码 | 维度预案 | 专家意见 |
|---------|---------|---------|
| CT001   | 4D      | 4D      |
| MRI002  | 4D      | 4D      |
```

**按名称匹配**：
```
| 收费名称 | 维度预案 | 专家意见 |
|---------|---------|---------|
| CT检查   | 4D      | 4D      |
| 核磁共振 | 4D      | 4D      |
```

### 步骤2：字段映射

1. 上传Excel文件
2. 选择匹配方式：
   - ○ 按收费编码匹配
   - ● 按收费名称匹配
3. 选择对应的列：
   - 收费编码/名称
   - 维度预案（可选）
   - 专家意见（可选）
4. 点击"下一步"

### 步骤3：维度值映射

1. 系统显示Excel中的唯一值
2. 为每个值选择对应的维度
3. 可以选择多个维度
4. 点击"下一步"

**示例**：
```
Excel值: "4D"
来源: 专家意见
出现次数: 120次

选择维度:
☑ 医疗服务 > 检查 > CT检查
☑ 医疗服务 > 检查 > MRI检查
```

### 步骤4：预览与确认

查看导入预览：

```
| 收费编码 | 收费名称 | 维度     | 状态 | 说明 |
|---------|---------|---------|------|------|
| CT001   | CT检查   | CT检查   | ✅ OK | 将被覆盖 |
| MRI002  | MRI检查  | MRI检查  | ✅ OK |      |
| LAB003  |         | 血常规   | ⚠️ Warning | 项目不存在 |
```

状态说明：
- ✅ OK：可以正常导入
- ⚠️ Warning：有警告，但可以导入
- ❌ Error：有错误，无法导入

### 步骤5：执行导入

1. 检查预览结果
2. 点击"确认导入"
3. 等待导入完成
4. 查看导入报告

## 覆盖功能说明 ⭐

### 什么是覆盖？

当导入的记录已经存在时，系统会：
1. 删除旧记录
2. 创建新记录
3. 实现"更新"效果

### 使用场景

**场景1：更新维度分类**
```
旧数据: CT001 → 3D
新数据: CT001 → 4D
结果: CT001 → 4D (覆盖)
```

**场景2：批量更新**
```
导入100条记录
其中50条已存在 → 覆盖
其中50条是新的 → 新增
```

### 预览提示

已存在的记录会显示：
```
状态: ✅ OK
消息: 该收费项目已存在，将被覆盖
```

### 注意事项

⚠️ **覆盖是不可逆的**
- 旧记录会被永久删除
- 建议在预览步骤仔细检查
- 如有疑问，可以先备份数据

## 常用操作

### 1. 查看特定维度的项目

```
模型版本: [2024版]
维度: [医疗服务 > 检查 > CT检查]
[查询]
```

### 2. 搜索收费项目

```
模型版本: [2024版]
维度: [医疗服务 > 检查 > CT检查]
关键词: [CT]
[查询]
```

### 3. 清空维度的所有项目

```
1. 选择维度
2. 点击"查询"
3. 点击"全部清除"
4. 确认清空
```

### 4. 删除单个项目

```
1. 在列表中找到要删除的项目
2. 点击"删除"按钮
3. 确认删除
```

### 5. 清理孤儿记录

```
1. 点击"查看孤儿记录"
2. 点击"清除所有孤儿记录"
3. 确认清除
```

## 界面说明

```
┌────────────────────────────────────────────────────────┐
│ 维度目录管理                                            │
│                    [全部清除] [智能导入] [添加收费项目]  │
├────────────────────────────────────────────────────────┤
│ 模型版本: [2024版 ▼]                                   │
│ 维度: [医疗服务 > 检查 > CT检查 ▼]                     │
│ 关键词: [搜索框]                                        │
│ [查询] [查看孤儿记录]                                   │
├────────────────────────────────────────────────────────┤
│ 收费编码 | 收费名称 | 项目分类 | 添加时间 | 操作        │
│ CT001   | CT检查   | 检查     | 2024-10  | [删除]      │
│ MRI002  | MRI检查  | 检查     | 2024-10  | [删除]      │
└────────────────────────────────────────────────────────┘
```

## 提示与技巧

### 💡 提示1：使用维度下拉选择
- 不需要记住维度ID
- 显示完整路径，一目了然
- 支持搜索，快速定位

### 💡 提示2：智能导入更高效
- 批量导入，节省时间
- 自动匹配维度
- 支持覆盖更新

### 💡 提示3：定期清理孤儿记录
- 点击"查看孤儿记录"
- 检查是否有无效数据
- 一键清除

### 💡 提示4：使用按名称匹配
- Excel中只有名称时使用
- 系统自动转换为编码
- 预览时检查转换结果

### 💡 提示5：预览很重要
- 导入前仔细检查预览
- 注意警告和错误提示
- 确认无误后再导入

## 常见问题

### Q: 维度下拉框是空的？
A: 该模型版本没有末级维度，需要在模型管理中设置。

### Q: 导入时提示"项目不存在"？
A: 收费编码/名称在系统中不存在，会创建孤儿记录，可以后续清理。

### Q: 如何更新已有的映射？
A: 使用智能导入，系统会自动覆盖已存在的记录。

### Q: 覆盖后可以恢复吗？
A: 不能恢复，建议导入前备份数据。

### Q: 可以同时导入多个维度吗？
A: 可以，在维度值映射步骤为每个值选择多个维度。

## 相关文档

- [界面优化更新](DIMENSION_ITEMS_UI_UPDATE.md)
- [智能导入完整文档](DIMENSION_SMART_IMPORT_COMPLETED.md)
- [按名称匹配功能](DIMENSION_IMPORT_MATCH_BY_NAME.md)
- [孤儿记录清理](ORPHAN_RECORDS_QUICK_GUIDE.md)
