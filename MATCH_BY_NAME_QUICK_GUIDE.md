# 按名称匹配 - 快速使用指南

## 什么时候使用？

当你的Excel文件中**只有收费项目名称，没有编码**时，使用"按收费名称匹配"功能。

## 快速步骤

### 1. 打开智能导入
点击"智能导入"按钮

### 2. 上传Excel文件
拖拽或点击上传包含收费项目名称的Excel文件

### 3. 选择匹配方式 ⭐ 新功能
选择 **"按收费名称匹配"**

### 4. 选择列
选择包含收费项目**名称**的列（不是编码列）

### 5. 继续后续步骤
- 映射维度值
- 预览确认
- 执行导入

## 示例对比

### ❌ 之前（只能用编码）

Excel必须有编码列：
```
收费编码  | 维度预案
CT001    | 4D
MRI002   | 4D
```

### ✅ 现在（可以用名称）

Excel可以只有名称列：
```
收费名称  | 维度预案
CT检查   | 4D
核磁共振  | 4D
```

系统会自动转换：
- `CT检查` → `CT001`
- `核磁共振` → `MRI002`

## 注意事项

⚠️ **名称必须完全匹配**
- `CT检查` ✅
- `CT 检查`（多空格）❌
- `ct检查`（大小写）❌

⚠️ **如果名称不存在**
- 会标记为warning
- 可以选择跳过或导入后清理

## 界面说明

```
┌─────────────────────────────────────────┐
│ 匹配方式                                 │
│ ○ 按收费编码匹配                         │
│ ● 按收费名称匹配  ← 选择这个              │
│                                         │
│ 提示：使用Excel中的收费名称匹配，         │
│      系统会自动转换为对应的收费编码       │
├─────────────────────────────────────────┤
│ 收费名称 *                               │
│ [选择列 ▼]  ← 选择包含名称的列           │
└─────────────────────────────────────────┘
```

## 完整示例

### Excel文件内容
```
| 收费项目名称 | 维度预案 | 专家意见 |
|------------|---------|---------|
| CT检查      | 4D      | 4D      |
| 核磁共振    | 4D      | 4D      |
| 血常规      | 3D      | 3D      |
```

### 操作步骤
1. 上传Excel
2. 选择"按收费名称匹配"
3. 选择"收费项目名称"列
4. 选择"维度预案"和"专家意见"列
5. 映射维度值
6. 预览（会显示转换后的编码）
7. 确认导入

### 预览结果
```
| 收费编码 | 收费名称 | 维度   | 状态 |
|---------|---------|-------|------|
| CT001   | CT检查   | 4D    | ✅ OK |
| MRI002  | 核磁共振 | 4D    | ✅ OK |
| LAB003  | 血常规   | 3D    | ✅ OK |
```

## 常见问题

**Q: 我的Excel既有编码又有名称，用哪个？**
A: 优先使用编码（更准确）。如果编码不完整，可以分两次导入。

**Q: 名称匹配不到怎么办？**
A: 会显示warning，你可以：
- 跳过这些记录
- 导入后使用"查看孤儿记录"清理
- 修正Excel中的名称后重新导入

**Q: 会不会匹配错？**
A: 只要名称完全一致就不会错。如果担心，可以在预览步骤仔细检查。

## 相关功能

- [查看孤儿记录](ORPHAN_RECORDS_QUICK_GUIDE.md) - 清理匹配失败的记录
- [智能导入完整文档](DIMENSION_SMART_IMPORT_COMPLETED.md) - 了解更多功能

## 提示

💡 **最佳实践**：
1. 如果Excel中有编码，优先使用"按编码匹配"
2. 如果只有名称，使用"按名称匹配"
3. 导入前在预览步骤仔细检查转换结果
4. 导入后使用"查看孤儿记录"检查是否有匹配失败的记录
