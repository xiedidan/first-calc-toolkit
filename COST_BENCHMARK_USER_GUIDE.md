# 成本基准管理 - 用户使用指南

## 目录

1. [功能概述](#功能概述)
2. [快速开始](#快速开始)
3. [功能详解](#功能详解)
4. [常见问题](#常见问题)
5. [最佳实践](#最佳实践)

---

## 功能概述

### 什么是成本基准管理？

成本基准管理功能用于记录和管理医院各科室在不同模型版本下各维度的成本参考值。这些基准值可以作为：

- **成本控制标准**: 为科室设定成本控制目标
- **绩效评估依据**: 对比实际成本与基准值，评估科室绩效
- **预算编制参考**: 为下一年度预算编制提供数据支持
- **成本分析工具**: 分析不同科室、不同维度的成本差异

### 主要功能

- ✅ **数据管理**: 添加、编辑、删除成本基准记录
- ✅ **多维筛选**: 按模型版本、科室、维度筛选数据
- ✅ **关键词搜索**: 在科室名称和维度名称中快速搜索
- ✅ **数据导出**: 将筛选后的数据导出为Excel文件
- ✅ **数据隔离**: 不同医疗机构的数据完全独立

---

## 快速开始

### 第一步：访问功能页面

1. 登录系统
2. 在左侧菜单中找到"成本基准管理"
3. 点击进入成本基准管理页面

### 第二步：添加第一条成本基准

1. 点击页面右上角的"添加成本基准"按钮
2. 在弹出的对话框中填写信息：
   - **科室**: 选择要设置基准的科室
   - **模型版本**: 选择适用的模型版本
   - **维度**: 选择要设置基准的维度
   - **基准值**: 输入成本基准值（必须大于0）
3. 点击"确定"按钮保存

### 第三步：查看和管理数据

- 在列表中查看已添加的成本基准
- 使用筛选条件快速定位数据
- 点击"编辑"按钮修改基准值
- 点击"删除"按钮移除不需要的记录

---

## 功能详解

### 1. 数据列表

#### 列表展示

成本基准列表以表格形式展示，包含以下信息：

| 列名 | 说明 |
|------|------|
| 科室名称 | 成本基准所属的科室 |
| 模型版本 | 适用的模型版本 |
| 维度名称 | 成本基准对应的维度 |
| 基准值 | 成本基准数值（自动格式化为千分位） |
| 创建时间 | 记录创建的时间 |
| 更新时间 | 记录最后更新的时间 |
| 操作 | 编辑和删除按钮 |

#### 分页功能

- 默认每页显示20条记录
- 可选择每页显示10、20、50或100条记录
- 使用页码快速跳转到指定页面
- 显示总记录数

### 2. 筛选和搜索

#### 按模型版本筛选

1. 点击"模型版本"下拉框
2. 选择要查看的模型版本
3. 系统自动刷新列表，只显示该版本的成本基准

**提示**: 选择"全部"可查看所有版本的数据

#### 按科室筛选

1. 点击"科室"下拉框
2. 输入科室名称进行搜索（支持模糊匹配）
3. 选择要查看的科室
4. 系统自动刷新列表

#### 按维度筛选

1. 点击"维度"下拉框
2. 输入维度名称进行搜索（支持模糊匹配）
3. 选择要查看的维度
4. 系统自动刷新列表

#### 关键词搜索

1. 在"关键词"输入框中输入搜索内容
2. 系统会在科室名称和维度名称中进行模糊匹配
3. 支持实时搜索（输入后自动搜索）
4. 按回车键也可触发搜索

**搜索示例**:
- 输入"内科"：查找所有科室名称或维度名称包含"内科"的记录
- 输入"工作量"：查找所有维度名称包含"工作量"的记录

#### 组合筛选

可以同时使用多个筛选条件，系统会返回同时满足所有条件的记录。

**示例**: 
- 模型版本：2024年度模型
- 科室：内科
- 维度：门诊工作量
- 结果：只显示内科在2024年度模型下门诊工作量维度的成本基准

#### 重置筛选

点击"重置"按钮可清除所有筛选条件，恢复到初始状态。

### 3. 添加成本基准

#### 操作步骤

1. 点击页面右上角的"添加成本基准"按钮
2. 在弹出的对话框中填写以下信息：

**科室**（必填）
- 从下拉列表中选择科室
- 支持输入科室名称进行搜索
- 选择后系统自动填充科室代码和名称

**模型版本**（必填）
- 从下拉列表中选择模型版本
- 只显示当前医疗机构的模型版本
- 选择后系统自动填充版本名称

**维度**（必填）
- 从下拉列表中选择维度
- 支持输入维度名称进行搜索
- 选择后系统自动填充维度代码和名称

**基准值**（必填）
- 输入成本基准数值
- 必须大于0
- 最多保留2位小数
- 最大值为999,999,999.99

3. 点击"确定"按钮保存

#### 验证规则

系统会自动验证输入的数据：

- ✅ 所有必填字段必须填写
- ✅ 基准值必须大于0
- ✅ 基准值不能超过最大限制
- ✅ 同一科室、版本、维度的组合不能重复

#### 错误提示

如果输入的数据不符合要求，系统会显示相应的错误提示：

- "请选择科室"
- "请选择模型版本"
- "请选择维度"
- "请输入基准值"
- "基准值必须大于0"
- "该科室在该模型版本下的该维度成本基准已存在"

### 4. 编辑成本基准

#### 操作步骤

1. 在列表中找到要编辑的记录
2. 点击该记录右侧的"编辑"按钮
3. 在弹出的对话框中修改信息
4. 点击"确定"按钮保存修改

#### 可编辑字段

所有字段都可以修改：
- 科室
- 模型版本
- 维度
- 基准值

#### 注意事项

- 修改后的组合（科室+版本+维度）不能与其他记录重复
- 基准值必须大于0
- 修改会更新"更新时间"字段

### 5. 删除成本基准

#### 操作步骤

1. 在列表中找到要删除的记录
2. 点击该记录右侧的"删除"按钮
3. 在确认对话框中点击"确定"

#### 安全提示

- 删除操作不可恢复，请谨慎操作
- 系统会弹出确认对话框，防止误删除
- 删除后列表会自动刷新

### 6. 导出Excel

#### 操作步骤

1. （可选）使用筛选条件过滤要导出的数据
2. 点击页面右上角的"导出Excel"按钮
3. 系统会生成Excel文件并自动下载

#### 导出内容

导出的Excel文件包含以下列：

1. 科室代码
2. 科室名称
3. 模型版本名称
4. 维度代码
5. 维度名称
6. 基准值
7. 创建时间
8. 更新时间

#### 文件命名

导出的文件名格式为：`成本基准_YYYYMMDD_HHMMSS.xlsx`

例如：`成本基准_20240101_120000.xlsx`

#### 注意事项

- 导出会包含当前筛选条件下的所有数据（不受分页限制）
- 如果没有数据，系统会提示"没有可导出的数据"
- 导出过程中会显示加载状态
- 大数据量导出可能需要等待几秒钟

---

## 常见问题

### Q1: 为什么我看不到其他医疗机构的数据？

**A**: 系统实现了多租户数据隔离，每个医疗机构只能查看和管理自己的数据。这是为了保护数据安全和隐私。

### Q2: 为什么提示"该科室在该模型版本下的该维度成本基准已存在"？

**A**: 系统不允许同一科室在同一模型版本下的同一维度有多个成本基准。如果需要修改，请使用"编辑"功能更新现有记录。

### Q3: 基准值可以设置为0吗？

**A**: 不可以。基准值必须大于0，因为成本基准应该是一个正数。如果某个维度不需要设置基准，可以不创建该记录。

### Q4: 如何批量导入成本基准？

**A**: 当前版本暂不支持批量导入功能。您可以：
1. 使用"添加成本基准"功能逐条添加
2. 联系技术支持团队协助批量导入

### Q5: 导出的Excel文件中文乱码怎么办？

**A**: 系统已正确处理中文编码，如果出现乱码：
1. 确保使用最新版本的Excel打开文件
2. 尝试使用WPS Office打开
3. 联系技术支持团队

### Q6: 删除成本基准后可以恢复吗？

**A**: 不可以。删除操作是永久性的，无法恢复。建议在删除前：
1. 确认是否真的需要删除
2. 导出数据作为备份

### Q7: 为什么搜索没有结果？

**A**: 可能的原因：
1. 关键词拼写错误
2. 筛选条件过于严格
3. 确实没有匹配的数据

建议：
- 检查关键词拼写
- 点击"重置"按钮清除所有筛选条件
- 尝试使用更宽泛的搜索词

### Q8: 基准值的小数位数有限制吗？

**A**: 是的，基准值最多保留2位小数。系统会自动四舍五入到2位小数。

### Q9: 可以为同一科室设置多个维度的基准吗？

**A**: 可以。一个科室可以在同一模型版本下设置多个不同维度的成本基准。

### Q10: 如何查看历史修改记录？

**A**: 当前版本只显示最后更新时间，不保存完整的修改历史。如需详细的审计日志，请联系技术支持团队。

---

## 最佳实践

### 1. 数据录入

#### 建议流程

1. **准备数据**: 在Excel中整理好要录入的成本基准数据
2. **按版本录入**: 先完成一个模型版本的所有数据，再录入下一个版本
3. **按科室录入**: 在同一版本内，按科室顺序录入，避免遗漏
4. **及时验证**: 录入后立即使用筛选功能验证数据完整性

#### 数据质量检查

- ✅ 确保科室代码和名称准确
- ✅ 确认模型版本选择正确
- ✅ 验证维度选择与实际业务匹配
- ✅ 检查基准值的数量级是否合理

### 2. 数据维护

#### 定期审查

建议每季度审查一次成本基准数据：

1. 检查是否有过时的数据需要删除
2. 根据实际情况调整基准值
3. 补充新增科室或维度的基准

#### 版本管理

- 为每个年度创建独立的模型版本
- 新年度开始时，可以参考上一年度的基准值
- 保留历史版本的数据，便于对比分析

### 3. 数据分析

#### 导出数据用于分析

1. 使用筛选功能选择要分析的数据范围
2. 导出为Excel文件
3. 在Excel中进行进一步的数据分析和可视化

#### 对比分析

- 对比不同科室在同一维度的基准值
- 对比同一科室在不同维度的基准值
- 对比不同年度的基准值变化趋势

### 4. 权限管理

#### 建议的权限设置

- **管理员**: 拥有所有权限（添加、编辑、删除、导出）
- **财务人员**: 可以添加、编辑、导出，但不能删除
- **普通用户**: 只能查看和导出

### 5. 数据备份

#### 备份策略

1. **定期导出**: 每月导出一次完整数据作为备份
2. **版本归档**: 每个模型版本完成后导出归档
3. **重要操作前备份**: 批量修改或删除前先导出备份

#### 备份文件管理

- 使用统一的文件命名规则
- 按年度和月份组织备份文件
- 定期清理过期的备份文件

### 6. 性能优化

#### 大数据量处理

如果成本基准记录超过1000条：

1. 使用筛选条件缩小查询范围
2. 适当增加每页显示数量（如50或100条）
3. 导出时使用筛选条件，避免一次导出所有数据

#### 搜索优化

- 使用精确的筛选条件而非关键词搜索
- 组合使用多个筛选条件快速定位数据
- 避免使用过于宽泛的搜索词

---

## 技术支持

如果您在使用过程中遇到问题或有任何建议，请联系技术支持团队：

- **邮箱**: support@example.com
- **电话**: 400-xxx-xxxx
- **工作时间**: 周一至周五 9:00-18:00

---

## 附录

### 术语表

| 术语 | 说明 |
|------|------|
| 成本基准 | 特定科室在某个维度下的成本参考值 |
| 模型版本 | 评估模型的特定版本，通常按年度划分 |
| 维度 | 评估模型中的评估维度，如门诊工作量、住院工作量等 |
| 多租户 | 系统支持多个医疗机构独立使用，数据完全隔离 |

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| Enter | 在关键词输入框中按Enter触发搜索 |
| Esc | 关闭对话框 |

### 浏览器兼容性

推荐使用以下浏览器访问系统：

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Edge 90+
- ✅ Safari 14+

---

**文档版本**: v1.0.0  
**最后更新**: 2024-11-27  
**适用系统版本**: v1.0.0+
