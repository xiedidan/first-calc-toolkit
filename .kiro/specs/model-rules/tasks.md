# 实现任务列表 - 模型规则展示功能

## 任务概述

本任务列表定义了实现模型规则展示功能的具体步骤。该功能为模型节点添加规则字段，并提供独立的规则展示页面。

## 任务列表

- [x] 1. 验证后端支持





  - 验证 `model_nodes` 表中 `rule` 字段已存在
  - 验证后端API已支持 `rule` 字段的读写
  - 验证前端API类型定义已包含 `rule` 字段
  - _Requirements: 5.1, 5.2, 5.3_

- [x] 2. 修改 ModelVersions.vue 添加"查看规则"按钮





  - 在操作列添加"查看规则"按钮（使用 Document 图标）
  - 实现 `handleViewRules` 方法，导航到规则展示页面
  - 按钮位置在"编辑结构"按钮之后
  - _Requirements: 3.1_

- [x] 3. 创建 ModelRules.vue 规则展示页面




- [x] 3.1 创建页面基础结构


  - 创建 `frontend/src/views/ModelRules.vue` 文件
  - 实现页面布局（Card + Header + Tree）
  - 添加返回按钮和页面标题
  - _Requirements: 3.2, 3.3_

- [x] 3.2 实现数据加载逻辑


  - 从路由参数获取 `versionId`
  - 调用 `getModelVersion` 获取版本信息
  - 调用 `getModelNodes` 获取节点数据
  - 实现加载状态和错误处理
  - _Requirements: 3.2, 3.3_

- [x] 3.3 实现树形结构展示


  - 使用 Element Plus Tree 组件
  - 配置树形属性（node-key, default-expand-all）
  - 实现自定义节点模板
  - 显示节点名称、编码、类型标签
  - _Requirements: 3.3, 3.4, 4.1, 4.2_

- [x] 3.4 实现规则内容展示


  - 在节点下方显示规则说明
  - 使用 `white-space: pre-wrap` 保持文本格式
  - 处理空规则情况（显示"暂无规则说明"）
  - 添加规则内容样式（背景色、边框、内边距）
  - _Requirements: 3.4, 3.5_

- [x] 4. 配置路由





  - 在 `frontend/src/router/index.ts` 添加新路由
  - 路由路径：`/model-rules/:versionId`
  - 路由名称：`ModelRules`
  - 配置路由元信息（title）
  - _Requirements: 3.1_

- [x] 5. 验证 ModelNodes.vue 规则输入功能










  - 确认编辑对话框中已有规则输入框
  - 确认规则输入框支持多行文本（textarea）
  - 确认显示字数统计（maxlength=1000, show-word-limit）
  - 确认规则字段为可选项
  - 确认保存时包含 `rule` 字段
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5_


- [x] 6. 样式优化





  - 实现节点信息样式（名称、编码、标签）
  - 实现规则内容样式（背景、边框、内边距）
  - 实现空规则提示样式（浅灰色、斜体）
  - 确保与现有页面风格一致



  - _Requirements: 4.3, 4.4_

- [x] 7. 测试和验证






  - 测试从版本列表导航到规则展示页面
  - 测试规则内容的正确显示（包括换行、空格）
  - 测试空规则的显示
  - 测试树形结构的展开/收起
  - 测试返回按钮功能
  - 测试加载状态和错误处理
  - _Requirements: 所有需求_

## 任务依赖关系

```
1 (验证后端支持)
  ↓
2 (添加查看规则按钮) ← 4 (配置路由)
  ↓                      ↓
3 (创建规则展示页面)
  ├─ 3.1 (基础结构)
  ├─ 3.2 (数据加载)
  ├─ 3.3 (树形展示)
  └─ 3.4 (规则展示)
  ↓
5 (验证规则输入) + 6 (样式优化)
  ↓
7 (测试和验证)
```

## 注意事项

1. **后端无需修改** - 数据库字段和API接口已完整支持，只需验证
2. **规则字段为可选** - 所有节点都可以选填规则，不是必填项
3. **保持文本格式** - 规则内容需要保持换行和空格，使用 `white-space: pre-wrap`
4. **默认展开所有节点** - 使用 `default-expand-all` 属性
5. **UI风格一致** - 与现有的模型管理页面保持一致的风格

## 验收标准

- [ ] 用户可以在模型版本列表点击"查看规则"按钮
- [ ] 规则展示页面以树形结构显示所有节点
- [ ] 每个节点显示名称、编码、类型标签
- [ ] 规则内容正确显示（保持文本格式）
- [ ] 空规则显示"暂无规则说明"提示
- [ ] 用户可以展开/收起节点
- [ ] 用户可以返回版本列表
- [ ] 页面加载状态和错误处理正常
- [ ] UI风格与现有页面一致
