# UI优化 v2 - 表格布局改进

> **更新日期**: 2025-10-22  
> **版本**: v1.2

---

## 🎨 优化内容

### 1. 列宽调整

**节点名称和节点编码统一宽度**
- 节点名称：200px
- 节点编码：200px
- 两列宽度一致，视觉更整齐

### 2. 排序列独立显示

**排序列改进**:
- 独立的"排序"列，不与树形结构混在一起
- 宽度：100px，居中对齐
- 支持层级缩进显示
  - 根节点：无缩进
  - 一级子节点：缩进 20px
  - 二级子节点：缩进 40px
  - 以此类推...

**视觉效果**:
```
排序列：
  1        (根节点)
    1.1    (一级子节点，缩进20px)
      1.1.1  (二级子节点，缩进40px)
    1.2
  2
    2.1
```

### 3. 其他优化

- 所有标签使用 `size="small"` 更紧凑
- 操作按钮使用 `size="small"` 更协调
- 列对齐优化：
  - 文本列：左对齐
  - 数值列：居中对齐
  - 操作列：居中对齐
- 添加 `show-overflow-tooltip` 防止文本溢出

---

## 📊 表格列配置

| 列名 | 宽度 | 对齐 | 说明 |
|------|------|------|------|
| 排序 | 100px | 居中 | 支持层级缩进 |
| 节点名称 | 200px | 左对齐 | 固定宽度 |
| 节点编码 | 200px | 左对齐 | 固定宽度 |
| 节点类型 | 100px | 居中 | 标签显示 |
| 末级维度 | 100px | 居中 | 标签显示 |
| 计算类型 | 100px | 居中 | 标签显示 |
| 权重/单价 | 110px | 居中 | 数值显示 |
| 业务导向 | 自适应 | 左对齐 | 最小180px |
| 操作 | 250px | 居中 | 固定右侧 |

---

## 🎯 视觉效果

### 优化前
```
┌────┬──────────────┬────────┬────┬────┬────┬────┬────────┬────────┐
│排序│节点名称      │编码    │类型│末级│计算│权重│业务导向│操作    │
├────┼──────────────┼────────┼────┼────┼────┼────┼────────┼────────┤
│1   │医生序列      │DOCTOR  │序列│-   │-   │-   │...     │[操作]  │
│  1 │  门诊诊察    │OUTPT   │维度│是  │统计│0.3 │...     │[操作]  │
└────┴──────────────┴────────┴────┴────┴────┴────┴────────┴────────┘
```
*问题：排序列与树形箭头混在一起，不够清晰*

### 优化后
```
┌────────┬────────────────┬────────────────┬────┬────┬────┬────┬────────┬────────┐
│  排序  │节点名称        │节点编码        │类型│末级│计算│权重│业务导向│操作    │
├────────┼────────────────┼────────────────┼────┼────┼────┼────┼────────┼────────┤
│   1    │医生序列        │DOCTOR          │序列│-   │-   │-   │...     │[操作]  │
│     1  │  门诊诊察      │OUTPATIENT      │维度│是  │统计│0.3 │...     │[操作]  │
│       1│    门诊挂号    │OUTPT_REG       │维度│是  │统计│0.1 │...     │[操作]  │
│     2  │  住院诊察      │INPATIENT       │维度│是  │计算│0.7 │...     │[操作]  │
│   2    │护理序列        │NURSE           │序列│-   │-   │-   │...     │[操作]  │
└────────┴────────────────┴────────────────┴────┴────┴────┴────┴────────┴────────┘
```
*改进：排序列独立，支持层级缩进，更清晰*

---

## 💡 层级缩进逻辑

### 计算规则
```javascript
// 根节点：level = 0，缩进 0px
// 一级子节点：level = 1，缩进 20px
// 二级子节点：level = 2，缩进 40px
// 缩进 = level * 20px

const getNodeLevel = (node) => {
  // 递归查找父节点，计算层级深度
  // 返回层级数字
}
```

### 显示效果
```
1          ← 根节点（level 0）
  1.1      ← 一级子节点（level 1，缩进20px）
    1.1.1  ← 二级子节点（level 2，缩进40px）
  1.2      ← 一级子节点（level 1，缩进20px）
2          ← 根节点（level 0）
```

---

## 🎨 样式细节

### 标签大小
```vue
<el-tag size="small">序列</el-tag>
```

### 按钮大小
```vue
<el-button size="small">编辑</el-button>
```

### 文本溢出
```vue
<el-table-column show-overflow-tooltip />
```

### 列对齐
```vue
<el-table-column align="center" />  <!-- 居中 -->
<el-table-column align="left" />    <!-- 左对齐 -->
```

---

## 📝 使用体验

### 优点

1. **更清晰的排序显示**
   - 排序列独立，不与树形结构混淆
   - 层级缩进直观显示节点深度
   - 方便查看和调整排序

2. **更整齐的布局**
   - 节点名称和编码列宽一致
   - 所有列对齐统一
   - 视觉更协调

3. **更紧凑的界面**
   - 小号标签和按钮
   - 节省空间
   - 信息密度更高

---

## 🔄 无需迁移

此次优化只涉及前端UI，无需执行数据库迁移。

**刷新浏览器即可看到效果！**

---

## 📸 对比示例

### 示例数据结构
```
1. 医生序列 (DOCTOR)
   1.1 门诊诊察 (OUTPATIENT)
       1.1.1 门诊挂号 (OUTPT_REG)
       1.1.2 门诊检查 (OUTPT_EXAM)
   1.2 住院诊察 (INPATIENT)
2. 护理序列 (NURSE)
   2.1 基础护理 (BASIC_CARE)
   2.2 专科护理 (SPECIAL_CARE)
```

### 排序列显示
```
┌────────┐
│  排序  │
├────────┤
│   1    │  ← 医生序列
│     1  │  ← 门诊诊察（缩进20px）
│       1│  ← 门诊挂号（缩进40px）
│       2│  ← 门诊检查（缩进40px）
│     2  │  ← 住院诊察（缩进20px）
│   2    │  ← 护理序列
│     1  │  ← 基础护理（缩进20px）
│     2  │  ← 专科护理（缩进20px）
└────────┘
```

---

## 🎉 优化效果

- ✅ 排序列独立显示
- ✅ 支持层级缩进
- ✅ 节点名称和编码列宽一致
- ✅ 整体布局更整齐
- ✅ 视觉效果更清晰
- ✅ 用户体验更好

---

## 📚 相关文档

- [优化更新 v1](./OPTIMIZATION_UPDATE.md)
- [模型管理文档](./MODEL_VERSION_COMPLETED.md)
- [前端实现文档](./MODEL_FRONTEND_COMPLETED.md)

---

**更新时间**: 2025-10-22  
**状态**: ✅ 已完成  
**无需迁移**: 刷新浏览器即可
